extends layout

block content
    <link href="/javascripts/video-js.css" rel="stylesheet" />
    .content.admin#app
        .tower
            .playerLTop(style='color:#555555')
                .playerLTopWr
                    .playerLTopButton(v-bind:class="{active:activeSect==1,red:!status.q}" v-on:click="activeSect=1")
                        <svg width="30" height="30" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M22.955 7.04502C20.8301 4.92022 18.005 3.75 15 3.75C11.995 3.75 9.16991 4.92022 7.04502 7.04502C4.92022 9.16991 3.75 11.995 3.75 15C3.75 16.9822 4.27014 18.9213 5.25671 20.6268L3.75 26.25L9.3732 24.7433C11.0787 25.7299 13.0178 26.25 15 26.25C18.005 26.25 20.8301 25.0798 22.955 22.955C25.0798 20.8301 26.25 18.005 26.25 15C26.25 11.995 25.0798 9.16991 22.955 7.04502ZM15.6592 20.603H14.3408V19.2847H15.6592V20.603ZM17.4562 14.89L15.6592 16.8997V17.9663H14.3408V16.3962L16.4736 14.011C16.7987 13.6479 16.9775 13.1798 16.9775 12.6929C16.9775 11.6025 16.0904 10.7153 15 10.7153C13.9096 10.7153 13.0225 11.6025 13.0225 12.6929H11.7041C11.7041 10.8755 13.1826 9.39697 15 9.39697C16.8174 9.39697 18.2959 10.8755 18.2959 12.6929C18.2959 13.5048 17.9977 14.285 17.4562 14.89Z" fill="#555555"/>
                        </svg>
                        div Вопросы ({{q.length}})
                    .playerLTopButton(v-bind:class="{active:activeSect==2}" v-on:click="activeSect=2")
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.594 0.75C5.16618 0.75 0.750778 4.3456 0.750778 8.76521C0.750778 11.0038 1.87572 13.1033 3.86124 14.6135C3.20456 15.6386 2.35523 16.6764 1.28372 16.9407C0.94483 17.0251 0.718436 17.3457 0.75359 17.693C0.788745 18.0418 1.0742 18.3103 1.42434 18.3258C1.4398 18.3258 1.50027 18.3286 1.60152 18.3286C2.32851 18.3286 5.13524 18.2119 8.32023 16.5597C9.05004 16.7073 9.81359 16.7804 10.594 16.7804C16.0205 16.7804 20.4373 13.1848 20.4373 8.76521C20.4373 4.3456 16.0205 0.75 10.594 0.75Z" fill="#555555"/>
                        <path d="M22.7148 21.8109C21.8191 21.5902 21.1413 20.9349 20.6674 20.2852C22.3169 18.993 23.2492 17.2155 23.2492 15.3214C23.2492 13.7353 22.5827 12.277 21.476 11.1113C20.2259 15.1738 15.8288 18.1872 10.5936 18.1872C9.89471 18.1872 9.20428 18.1338 8.53353 18.0283C8.13418 18.221 7.74326 18.3911 7.35938 18.543C8.77821 20.7226 11.5849 22.2117 14.8121 22.2117C15.4716 22.2117 16.1114 22.1512 16.7189 22.0331C18.7368 23.061 20.5774 23.2509 21.6602 23.2495C22.2536 23.2495 22.6192 23.1932 22.66 23.1862C22.989 23.1327 23.2351 22.8543 23.2492 22.5211C23.2618 22.1878 23.0397 21.8897 22.7148 21.8109Z" fill="#555555"/>
                        </svg>
                        div Техподдержка ({{chat.length}})
                    .playerLTopButton(v-bind:class="{active:activeSect==3, green:(votes.filter(v=>{return v.isactive}).length>0 )}" v-on:click="activeSect=3")
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.594 0.75C5.16618 0.75 0.750778 4.3456 0.750778 8.76521C0.750778 11.0038 1.87572 13.1033 3.86124 14.6135C3.20456 15.6386 2.35523 16.6764 1.28372 16.9407C0.94483 17.0251 0.718436 17.3457 0.75359 17.693C0.788745 18.0418 1.0742 18.3103 1.42434 18.3258C1.4398 18.3258 1.50027 18.3286 1.60152 18.3286C2.32851 18.3286 5.13524 18.2119 8.32023 16.5597C9.05004 16.7073 9.81359 16.7804 10.594 16.7804C16.0205 16.7804 20.4373 13.1848 20.4373 8.76521C20.4373 4.3456 16.0205 0.75 10.594 0.75Z" fill="#555555"/>
                        <path d="M22.7148 21.8109C21.8191 21.5902 21.1413 20.9349 20.6674 20.2852C22.3169 18.993 23.2492 17.2155 23.2492 15.3214C23.2492 13.7353 22.5827 12.277 21.476 11.1113C20.2259 15.1738 15.8288 18.1872 10.5936 18.1872C9.89471 18.1872 9.20428 18.1338 8.53353 18.0283C8.13418 18.221 7.74326 18.3911 7.35938 18.543C8.77821 20.7226 11.5849 22.2117 14.8121 22.2117C15.4716 22.2117 16.1114 22.1512 16.7189 22.0331C18.7368 23.061 20.5774 23.2509 21.6602 23.2495C22.2536 23.2495 22.6192 23.1932 22.66 23.1862C22.989 23.1327 23.2351 22.8543 23.2492 22.5211C23.2618 22.1878 23.0397 21.8897 22.7148 21.8109Z" fill="#555555"/>
                        </svg>
                        div Голосование
                    .playerLTopButton(v-bind:class="{active:activeSect==7, green:(raiting.filter(v=>{return v.isactive}).length>0 )}" v-on:click="activeSect=7")
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.594 0.75C5.16618 0.75 0.750778 4.3456 0.750778 8.76521C0.750778 11.0038 1.87572 13.1033 3.86124 14.6135C3.20456 15.6386 2.35523 16.6764 1.28372 16.9407C0.94483 17.0251 0.718436 17.3457 0.75359 17.693C0.788745 18.0418 1.0742 18.3103 1.42434 18.3258C1.4398 18.3258 1.50027 18.3286 1.60152 18.3286C2.32851 18.3286 5.13524 18.2119 8.32023 16.5597C9.05004 16.7073 9.81359 16.7804 10.594 16.7804C16.0205 16.7804 20.4373 13.1848 20.4373 8.76521C20.4373 4.3456 16.0205 0.75 10.594 0.75Z" fill="#555555"/>
                        <path d="M22.7148 21.8109C21.8191 21.5902 21.1413 20.9349 20.6674 20.2852C22.3169 18.993 23.2492 17.2155 23.2492 15.3214C23.2492 13.7353 22.5827 12.277 21.476 11.1113C20.2259 15.1738 15.8288 18.1872 10.5936 18.1872C9.89471 18.1872 9.20428 18.1338 8.53353 18.0283C8.13418 18.221 7.74326 18.3911 7.35938 18.543C8.77821 20.7226 11.5849 22.2117 14.8121 22.2117C15.4716 22.2117 16.1114 22.1512 16.7189 22.0331C18.7368 23.061 20.5774 23.2509 21.6602 23.2495C22.2536 23.2495 22.6192 23.1932 22.66 23.1862C22.989 23.1327 23.2351 22.8543 23.2492 22.5211C23.2618 22.1878 23.0397 21.8897 22.7148 21.8109Z" fill="#555555"/>
                        </svg>
                        div Рейтинг
                    .playerLTopButton(v-bind:class="{active:activeSect==4}" v-on:click="activeSect=4")
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.594 0.75C5.16618 0.75 0.750778 4.3456 0.750778 8.76521C0.750778 11.0038 1.87572 13.1033 3.86124 14.6135C3.20456 15.6386 2.35523 16.6764 1.28372 16.9407C0.94483 17.0251 0.718436 17.3457 0.75359 17.693C0.788745 18.0418 1.0742 18.3103 1.42434 18.3258C1.4398 18.3258 1.50027 18.3286 1.60152 18.3286C2.32851 18.3286 5.13524 18.2119 8.32023 16.5597C9.05004 16.7073 9.81359 16.7804 10.594 16.7804C16.0205 16.7804 20.4373 13.1848 20.4373 8.76521C20.4373 4.3456 16.0205 0.75 10.594 0.75Z" fill="#555555"/>
                        <path d="M22.7148 21.8109C21.8191 21.5902 21.1413 20.9349 20.6674 20.2852C22.3169 18.993 23.2492 17.2155 23.2492 15.3214C23.2492 13.7353 22.5827 12.277 21.476 11.1113C20.2259 15.1738 15.8288 18.1872 10.5936 18.1872C9.89471 18.1872 9.20428 18.1338 8.53353 18.0283C8.13418 18.221 7.74326 18.3911 7.35938 18.543C8.77821 20.7226 11.5849 22.2117 14.8121 22.2117C15.4716 22.2117 16.1114 22.1512 16.7189 22.0331C18.7368 23.061 20.5774 23.2509 21.6602 23.2495C22.2536 23.2495 22.6192 23.1932 22.66 23.1862C22.989 23.1327 23.2351 22.8543 23.2492 22.5211C23.2618 22.1878 23.0397 21.8897 22.7148 21.8109Z" fill="#555555"/>
                        </svg>
                        div Участники
                    .playerLTopButton(v-bind:class="{active:activeSect==6}" v-on:click="activeSect=6")
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.594 0.75C5.16618 0.75 0.750778 4.3456 0.750778 8.76521C0.750778 11.0038 1.87572 13.1033 3.86124 14.6135C3.20456 15.6386 2.35523 16.6764 1.28372 16.9407C0.94483 17.0251 0.718436 17.3457 0.75359 17.693C0.788745 18.0418 1.0742 18.3103 1.42434 18.3258C1.4398 18.3258 1.50027 18.3286 1.60152 18.3286C2.32851 18.3286 5.13524 18.2119 8.32023 16.5597C9.05004 16.7073 9.81359 16.7804 10.594 16.7804C16.0205 16.7804 20.4373 13.1848 20.4373 8.76521C20.4373 4.3456 16.0205 0.75 10.594 0.75Z" fill="#555555"/>
                        <path d="M22.7148 21.8109C21.8191 21.5902 21.1413 20.9349 20.6674 20.2852C22.3169 18.993 23.2492 17.2155 23.2492 15.3214C23.2492 13.7353 22.5827 12.277 21.476 11.1113C20.2259 15.1738 15.8288 18.1872 10.5936 18.1872C9.89471 18.1872 9.20428 18.1338 8.53353 18.0283C8.13418 18.221 7.74326 18.3911 7.35938 18.543C8.77821 20.7226 11.5849 22.2117 14.8121 22.2117C15.4716 22.2117 16.1114 22.1512 16.7189 22.0331C18.7368 23.061 20.5774 23.2509 21.6602 23.2495C22.2536 23.2495 22.6192 23.1932 22.66 23.1862C22.989 23.1327 23.2351 22.8543 23.2492 22.5211C23.2618 22.1878 23.0397 21.8897 22.7148 21.8109Z" fill="#555555"/>
                        </svg>
                        div Подразделения
                    .playerLTopButton(v-bind:class="{active:activeSect==5}" v-on:click="activeSect=5")
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10.594 0.75C5.16618 0.75 0.750778 4.3456 0.750778 8.76521C0.750778 11.0038 1.87572 13.1033 3.86124 14.6135C3.20456 15.6386 2.35523 16.6764 1.28372 16.9407C0.94483 17.0251 0.718436 17.3457 0.75359 17.693C0.788745 18.0418 1.0742 18.3103 1.42434 18.3258C1.4398 18.3258 1.50027 18.3286 1.60152 18.3286C2.32851 18.3286 5.13524 18.2119 8.32023 16.5597C9.05004 16.7073 9.81359 16.7804 10.594 16.7804C16.0205 16.7804 20.4373 13.1848 20.4373 8.76521C20.4373 4.3456 16.0205 0.75 10.594 0.75Z" fill="#555555"/>
                        <path d="M22.7148 21.8109C21.8191 21.5902 21.1413 20.9349 20.6674 20.2852C22.3169 18.993 23.2492 17.2155 23.2492 15.3214C23.2492 13.7353 22.5827 12.277 21.476 11.1113C20.2259 15.1738 15.8288 18.1872 10.5936 18.1872C9.89471 18.1872 9.20428 18.1338 8.53353 18.0283C8.13418 18.221 7.74326 18.3911 7.35938 18.543C8.77821 20.7226 11.5849 22.2117 14.8121 22.2117C15.4716 22.2117 16.1114 22.1512 16.7189 22.0331C18.7368 23.061 20.5774 23.2509 21.6602 23.2495C22.2536 23.2495 22.6192 23.1932 22.66 23.1862C22.989 23.1327 23.2351 22.8543 23.2492 22.5211C23.2618 22.1878 23.0397 21.8897 22.7148 21.8109Z" fill="#555555"/>
                        </svg>
                        div Статистика
            .adminBottom
                .playerRBottom(v-show="activeSect==1 " style="display:none" )
                    .qWr#qBox
                        .qItem
                            .buttonGroup
                                .button.green(v-on:click="changeStatus({q:false})" v-if="status.q") Выключить вопросы
                                .button(v-on:click="changeStatus({q:true})" v-if="!status.q") Включить вопросы
                                .button.red(v-on:click="deleteAllQ()") Удалить все вопросы
                        .qItem(v-for="item in q" v-if="q.length>0")
                            .qItemUser {{item.f}} {{item.i}}
                            .qItemDepartment {{item.short}}
                            .qItemText  {{item.text}}
                            .qItemGroup
                                .qitemLike()
                                    div
                                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 8.467 8.467"><path style="line-height:normal;font-variant-ligatures:normal;font-variant-position:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-alternates:normal;font-feature-settings:normal;text-indent:0;text-align:start;text-decoration-line:none;text-decoration-style:solid;text-decoration-color:#000;text-transform:none;text-orientation:mixed;shape-padding:0;isolation:auto;mix-blend-mode:normal" d="M1.322 7.674a.535.535 0 0 1-.53-.53V3.44c0-.289.242-.53.53-.53h.795c.196 0 .368.113.46.275.178-.11.353-.174.466-.239.266-.154.402-.586.465-1.037.031-.225.048-.442.076-.623.014-.09.027-.17.064-.258a.353.353 0 0 1 .32-.235c.393 0 .715.154.92.39.206.235.302.53.354.822.084.478.052.883.036 1.172h1.6c.436 0 .796.358.796.793 0 .154-.044.27-.1.45-.056.181-.131.399-.215.632-.166.466-.364.994-.494 1.383a1.32 1.32 0 0 1-.24.459.724.724 0 0 1-.539.251H2.91a.774.774 0 0 1-.264-.049v.05c0 .288-.24.529-.529.529zm0-.53h.795V3.44h-.795zm1.588-.529h3.176c.07 0 .092-.014.138-.068a.913.913 0 0 0 .14-.282c.135-.405.333-.932.497-1.392.082-.23.156-.443.207-.61.052-.166.077-.316.077-.294a.259.259 0 0 0-.266-.264H5.004a.265.265 0 0 1-.266-.266c0-.312.068-.87-.015-1.344-.042-.236-.12-.435-.233-.564a.607.607 0 0 0-.378-.199c-.027.151-.045.409-.079.65-.069.493-.199 1.117-.726 1.422-.197.113-.387.18-.5.258-.114.078-.16.12-.16.307v2.38c0 .152.112.266.263.266z" color="#000" font-family="sans-serif" font-weight="400" overflow="visible"/></svg>
                                    div {{item.likes}}
                                .qItemTime {{moment(item.date).format("HH:mm")}}
                            .buttonGroup
                                .button(v-if="!item.isApproved" v-on:click="changeQApproved(item)") Принять
                                .button.green(v-if="item.isApproved" v-on:click="changeQApproved(item)") Скрыть
                                .button(v-if="!item.isSpk" v-on:click="changeQSpk(item)") Показать спикеру
                                .button.green(v-if="item.isSpk" v-on:click="changeQSpk(item)") Удалить от спикера
                                .button.red(v-on:click="deleteQ(item)") Удалить

                    .sendWr
                        .sendBox
                            input#qInput(placeholder="Напишите ваш вопрос..." v-model="qText" )
                            <svg v-on:click="qSend()" width="15px" height="15px" viewBox="0 0 15 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svgSendBtn"><desc></desc> <defs></defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Desktop-HD" transform="translate(-712.000000, -505.000000)" fill-rule="nonzero"><g id="ic-baseline-call-made" transform="translate(708.000000, 500.000000)"><g id="Icon"><polygon id="Icon-Shape" fill="#9A9A9A" points="9 5 9 7 15.59 7 4 18.59 5.41 20 17 8.41 17 15 19 15 19 5"></polygon> <rect id="Icon-Rectangle-path" fill-opacity="0" fill="#000000" x="0" y="0" width="24" height="24"></rect></g></g></g></g></svg>
                            .sendBoxLoader(v-if="isLoading")
                                <svg class="spinner" viewBox="0 0 50 50">
                                <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
                                </svg>
                .playerRBottom(v-show="activeSect==2" style="display:none" )
                    .qWr#chatBox
                        .qItem
                            .buttonGroup

                                .button.red(v-on:click="deleteAllchat()") Удалить все
                        .qItem(v-for="item in chat" v-if="chat.length>0")
                            .qItemUser {{item.f}} {{item.i}}
                            .qItemDepartment {{item.short}}
                            .qItemText  {{item.text}}
                            .qItemText
                                textarea(v-model="item.answer" v-on:change="changeChatAnswer(item)" placeholder="ответ")
                            .qItemTime {{moment(item.date).format("HH:mm")}}
                            .buttonGroup
                                .button.red(v-on:click="deleteChat(item)") Удалить

                    .sendWr
                        .sendBox
                            input#chatInput(placeholder="Напишите ваш вопрос..."  v-model="chatText" maxlength="600")
                            <svg v-on:click="chatSend()" width="15px" height="15px" viewBox="0 0 15 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="svgSendBtn"><desc>Created with Sketch.</desc> <defs></defs> <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="Desktop-HD" transform="translate(-712.000000, -505.000000)" fill-rule="nonzero"><g id="ic-baseline-call-made" transform="translate(708.000000, 500.000000)"><g id="Icon"><polygon id="Icon-Shape" fill="#9A9A9A" points="9 5 9 7 15.59 7 4 18.59 5.41 20 17 8.41 17 15 19 15 19 5"></polygon> <rect id="Icon-Rectangle-path" fill-opacity="0" fill="#000000" x="0" y="0" width="24" height="24"></rect></g></g></g></g></svg>
                            .sendBoxLoader(v-if="isLoading")
                                <svg class="spinner" viewBox="0 0 50 50">
                                <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
                                </svg>
                .playerRBottom(v-show="activeSect==7" style="display:none" )
                    .qWr#reitingBox
                        .qItem(v-for="item in raiting" v-if="raiting.length>0" :id="'raiting'+item.id")
                            .qItemUser {{item.title}}
                            .qVoteAnswerWr
                                .qRaitingAnwerItem(v-for="answ in item.answers")
                                    .aanswCount {{answ.count}}
                                    input.aanswTitle(v-model="answ.title" v-on:change="answRaitingChange(answ)")
                                    .button(v-on:click="rVote(answ)") Проголосовать
                                    .button.red(v-on:click="deleteRaitingAnswer(answ)") Удалить ответ
                            .buttonGroup
                                .button(v-on:click="startRaiting(item)" v-if="!item.isactive") Запустить
                                .button.green(v-on:click="startRaiting(item)" v-if="item.isactive") Остановить
                                .button(v-on:click="resultRaiting(item)" v-if="!item.iscompl") Показан процесс
                                .button.green(v-on:click="resultRaiting(item)" v-if="item.iscompl") Показаны результаты
                                .button(v-on:click="addRaitingAnswer(item)") Добавить ответ
                                .button.red(v-on:click="deleteRaiting(item)") Удалить рейтинг
                    .sendWr
                        .sendBox
                            input(placeholder="Введите вопрос"  v-model="raitingTitle" maxlength="600")
                            .buttonGroup
                                .button(v-on:click="addRaiting()") добавить рейтинг
                .playerRBottom(v-show="activeSect==3" style="display:none" )
                    .qWr#voteBox
                        .qItem(v-for="item in votes" v-if="votes.length>0" :id="'vote'+item.id")
                            .qItemUser {{item.title}}
                                .qVoteAnswerWr
                                    .qVoteAnwerItem(v-for="answ in item.answers")
                                        .aanswCount  {{getAnswProc(item, answ.count)}} / {{answ.count}}
                                        input.aanswTitle(v-model="answ.title" v-on:change="answChange(answ)")
                                        .button(v-on:click="aVote(answ)") Проголосовать
                                        .button.red(v-on:click="deleteAnswer(answ)") Удалить вопрос
                            .buttonGroup
                                .button(v-on:click="startVote(item)" v-if="!item.isactive") Запустить
                                .button.green(v-on:click="startVote(item)" v-if="item.isactive") Остановить
                                .button(v-on:click="resultVote(item)" v-if="!item.iscompl") Показан процесс
                                .button.green(v-on:click="resultVote(item)" v-if="item.iscompl") Показаны результаты
                                .button(v-on:click="addAnswer(item)") Добавить ответ
                                .button.red(v-on:click="deleteVote(item)") Удалить голосование
                    .sendWr
                        .sendBox
                            input(placeholder="Введите вопрос"  v-model="voteTitle" maxlength="600")
                            .buttonGroup
                                .button(v-on:click="addVote()") добавить голосование
                .playerRBottom(v-show="activeSect==4" style="display:none" )
                    .qWr#usersBox
                        .qItem(v-for="user in users" v-if="users.length>0" :id="'user'+user.id")
                            .qItemUser {{user.f}} {{user.i}} {{user.code}}
                            .qItemDepartment
                                .adminUserLog(v-for="item in user.logins")
                                    .userSect {{moment(item.date).format('DD.MM HH:mm:ss')}} {{item.short}} {{item.ip}} {{item.Descr}}
                .playerRBottom(v-show="activeSect==6" style="display:none" )
                    .qWr#deptBox
                        .qItem(v-for="item in dept" v-if="dept.length>0" :id="'dept'+item.id")
                            .qItemUser
                                input(v-model="item.sort" v-on:change="changeDept(item)")
                                span &nbsp; {{item.title}}
                    .sendWr
                        .sendBox
                            input(placeholder="Фамилия"  v-model="userF" maxlength="600")
                            input(placeholder="Имя"  v-model="userI" maxlength="600")
                            .userCode КОД: {{userCode}}
                            .buttonGroup
                                .button(v-on:click="addUser()") добавить
                .playerRBottom(v-show="activeSect==5" style="display:none" )
                    .aNow сейчас смотрят: {{logs.users.length}}

                    #chart( style="width: 500px; height: 400px;")
    script(src="https://cdn.anychart.com/releases/8.11.0/js/anychart-base.min.js" type="text/javascript")
    script(src="/javascripts/vue.min.js")
    script(src="/javascripts/moment.min.js")
    script(src="/javascripts/adminScript.js")

